[package]
name = "minidumper"
version = "0.1.0"
edition = "2021"

[dependencies]
# Nicer cfg handling
cfg-if = "1.0"
crash-context = { version = "0.0.3", path = "../crash-context" }
libc = "0.2"
# Basic log emitting
log = "0.4"
# Minidump writing (currently linux/android only)
minidump-writer = "0.1"
# Nicer locking primitives
parking_lot = "0.12"
# Nicer error creation
thiserror = "1.0"

[target.'cfg(any(target_os = "linux", target_os = "android"))'.dependencies]
# Event loop
mio = "0.8"
# Improved Unix domain socket support, includes features that are not available in std
uds = { git = "https://github.com/EmbarkStudios/uds", branch = "master", features = [
    "mio_08",
] }

[target.'cfg(target_os = "windows")'.dependencies]
# Event loop
polling = "2.2"
# Nicer binary interop
scroll = "0.11"

[target.'cfg(target_os = "windows")'.dependencies.windows-sys]
version = "0.34" # Matches the version used in mio/miow
features = [
    "Win32_Foundation",         # Core types eg HANDLE
    "Win32_Networking_WinSock", # Sockets
    "Win32_System_IO",          # Sockets
    "Win32_Storage_FileSystem", # GetTempPath2W
    "Win32_System_Threading",   # *Event functions, OpenProcess
]

[dev-dependencies]
# catching crashes to request minidumps
exception-handler = { path = "../exception-handler" }
# uuid generation
uuid = { version = "0.8", features = ["v4"] }
backtrace = "0.3"
